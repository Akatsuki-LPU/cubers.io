{% extends "common/base.html" %}

{% block head %}
{{ super() }}
{% endblock %}

{% block content %}
<div class="container cubers-container" style="margin-top: 15px;">
    <h2>Leaderboards for {{ comp_name }}</h2>
    <div id="the-top" class="results-links-area">
        <div class="links-wrapper text-center">
        {% for event_name in event_names %}
        {% if event_results[event_name] %}
            <div class="event-link">
                <a href="#{{event_name}}">
                    <img class="event-image" src="/static/images/cube-{{ event_ids[event_name] }}.png">
                </a>
            </div>
        {% endif %}
        {% endfor %}
        </div>
    </div>
    <hr>

    {% for event_name in event_names %}
    {% if event_results[event_name] %}
        {% if event_formats[event_name] in ('Bo3', 'Bo1') %}
            {% set avg_class = '' %}
            {% set single_class = 'font-weight-bold' %}
        {% else %}
            {% set avg_class = 'font-weight-bold' %}
            {% set single_class = '' %}
        {% endif %}
        <div class="event-results-area">
            <div id="{{event_name}}" class="event-results-header">
                <img class="event-image" src="/static/images/cube-{{ event_ids[event_name] }}.png">
                <h3 class="event-name">{{ event_name }}</h3>
                <div class="return-link"><a href="#the-top"><span class="fas fa-arrow-up"></span></a></div>
            </div>
            <table class="table table-sm table-striped table-cubersio">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">User</th>
                        <th scope="col">Average</th>
                        <th scope="col">Best</th>
                        <th scope="col" colspan="5" class="d-none d-md-table-cell">Solves</th>
                    </tr>
                </thead>
                <tbody>
                    {% for result in event_results[event_name] %}
                    {% if current_user.is_authenticated and current_user.username == result.User.username %}
                        {% set its_me = 'hey-its-me' %}
                    {% else %}
                        {% set its_me = '' %}
                    {% endif %}
                    <tr class="{{ its_me }}">
                        <td scope="row">{{ loop.index }}</th>
                        <td scope="col">/u/{{ result.User.username }}</th>
                        {% if event_name == "FMC" %}
                            <td scope="col" class="font-weight-bold">{{ result.average | format_fmc_result }}</th>
                            <td scope="col">{{ result.single | format_fmc_result }}</th>
                            {% for solve in result.solves_helper %}
                            <td scope="col" class="d-none d-md-table-cell">{{ solve | format_fmc_result }}</th>
                            {% endfor %}
                        {% else %}
                            <td scope="col" class="{{ avg_class }}">{{ result.average | friendly_time }}</th>
                            <td scope="col" class="{{ single_class }}">{{ result.single | friendly_time }}</th>
                            {% for solve in result.solves_helper %}
                            <td scope="col" class="d-none d-md-table-cell">{{ solve | friendly_time }}</th>
                            {% endfor %}
                        {% endif %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% endif %}
    {% endfor %}
</div>
{% endblock %}

{% block additional_script %}
<script>
    window.addEventListener("hashchange", function () {
        window.scrollTo(window.scrollX, window.scrollY - 100);
    });
</script>
{% endblock %}